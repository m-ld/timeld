<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1087px" preserveAspectRatio="none" style="width:1330px;height:1087px;background:#FFFFFF;" version="1.1" viewBox="0 0 1330 1087" width="1330px" zoomAndPan="magnify"><defs/><g><!--MD5=[6de492f04047ff8a778df2bea690e363]
class Gateway--><g id="elem_Gateway"><rect codeLine="6" fill="#F1F1F1" height="87.2422" id="Gateway" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="167" x="375.5" y="142.5"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="55" x="431.5" y="159.1016">«domain»</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="52" x="433" y="173.2344">«service»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="430.5" y="189.3008">Gateway</text><line style="stroke:#181818;stroke-width:0.5;" x1="376.5" x2="541.5" y1="197.2539" y2="197.2539"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="155" x="381.5" y="214.7891">appMasterKey «secret»</text><line style="stroke:#181818;stroke-width:0.5;" x1="376.5" x2="541.5" y1="221.7422" y2="221.7422"/></g><!--MD5=[f9a29335b499db729be669fd1bd54958]
class Account--><g id="elem_Account"><rect codeLine="12" fill="#F1F1F1" height="103.7305" id="Account" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="183" x="298.5" y="317.5"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="59" x="360.5" y="334.1016">«abstract»</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="54" x="363" y="348.2344">«subject»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="362" y="364.3008">Account</text><line style="stroke:#181818;stroke-width:0.5;" x1="299.5" x2="480.5" y1="372.2539" y2="372.2539"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="171" x="304.5" y="389.7891">timesheet : Timesheet [*]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128" x="304.5" y="406.2773">project : Project [*]</text><line style="stroke:#181818;stroke-width:0.5;" x1="299.5" x2="480.5" y1="413.2305" y2="413.2305"/></g><path d="M516.5,319 L516.5,335.3105 L475.5,384.498 L516.5,343.3105 L516.5,359.6211 A0,0 0 0 0 516.5,359.6211 L735.5,359.6211 A0,0 0 0 0 735.5,359.6211 L735.5,329 L725.5,319 L516.5,319 A0,0 0 0 0 516.5,319 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M725.5,319 L725.5,329 L735.5,329 L725.5,319 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="522.5" y="336.5684">inverse injection: a Timesheet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="522.5" y="351.8789">can only appear in one Account</text><path d="M516.5,369.6211 L516.5,385.9316 L432.5,400.9863 L516.5,393.9316 L516.5,410.2422 A0,0 0 0 0 516.5,410.2422 L735.5,410.2422 A0,0 0 0 0 735.5,410.2422 L735.5,379.6211 L725.5,369.6211 L516.5,369.6211 A0,0 0 0 0 516.5,369.6211 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M725.5,369.6211 L725.5,379.6211 L735.5,379.6211 L725.5,369.6211 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="522.5" y="387.1895">inverse injection: a Project</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="522.5" y="402.5">can only appear in one Account</text><!--MD5=[0c2e12f724a2bba325ddf189ef351421]
class Timesheet--><g id="elem_Timesheet"><rect codeLine="48" fill="#F1F1F1" height="106.7305" id="Timesheet" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="141" x="430.5" y="974"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="55" x="473.5" y="990.6016">«domain»</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="54" x="474" y="1004.7344">«subject»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="465.5" y="1020.8008">Timesheet</text><line style="stroke:#181818;stroke-width:0.5;" x1="431.5" x2="570.5" y1="1028.7539" y2="1028.7539"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="54" x="436.5" y="1046.2891">account</text><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacing" textLength="7" x="490.5" y="1049.9219">p</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="64" x="501.5" y="1046.2891">: Account</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128" x="436.5" y="1065.7773">project : Project [*]</text><line style="stroke:#181818;stroke-width:0.5;" x1="431.5" x2="570.5" y1="1072.7305" y2="1072.7305"/></g><!--MD5=[79d378210367c0c6ec62ef762ddfbd1b]
class Project--><g id="elem_Project"><rect codeLine="67" fill="#F1F1F1" height="56.6211" id="Project" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="56" x="7" y="616"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="54" x="8" y="632.6016">«subject»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="11.5" y="648.668">Project</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="62" y1="656.6211" y2="656.6211"/><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="62" y1="664.6211" y2="664.6211"/></g><!--MD5=[873670755c6433d3512a8b316aa6820d]
class UserAccount--><g id="elem_UserAccount"><rect codeLine="29" fill="#F1F1F1" height="89.5977" id="UserAccount" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="139" x="577.5" y="141"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="54" x="620" y="157.6016">«subject»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="603.5" y="173.668">UserAccount</text><line style="stroke:#181818;stroke-width:0.5;" x1="578.5" x2="715.5" y1="181.6211" y2="181.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="583.5" y="199.1563">email : string [1..*]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="583.5" y="215.6445">key : UserKey [*]</text><line style="stroke:#181818;stroke-width:0.5;" x1="578.5" x2="715.5" y1="222.5977" y2="222.5977"/></g><path d="M751.5,160.5 L751.5,176.8105 L710.5,193.8652 L751.5,184.8105 L751.5,201.1211 A0,0 0 0 0 751.5,201.1211 L914.5,201.1211 A0,0 0 0 0 914.5,201.1211 L914.5,170.5 L904.5,160.5 L751.5,160.5 A0,0 0 0 0 751.5,160.5 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M904.5,160.5 L904.5,170.5 L914.5,170.5 L904.5,160.5 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="757.5" y="178.0684">Registered email, used</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="757.5" y="193.3789">for account activation</text><!--MD5=[f5f68a7b4d1daa3f868d0f655b773560]
class OrganisationAccount--><g id="elem_OrganisationAccount"><rect codeLine="39" fill="#F1F1F1" height="73.1094" id="OrganisationAccount" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="303" x="190.5" y="7"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="54" x="315" y="23.6016">«subject»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="145" x="269.5" y="39.668">OrganisationAccount</text><line style="stroke:#181818;stroke-width:0.5;" x1="191.5" x2="492.5" y1="47.6211" y2="47.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="291" x="196.5" y="65.1563">vf:primaryAccountable : UserAccount [1..*]</text><line style="stroke:#181818;stroke-width:0.5;" x1="191.5" x2="492.5" y1="72.1094" y2="72.1094"/></g><path d="M529,26 L529,34.6553 L487.5,59.8652 L529,42.6553 L529,51.3105 A0,0 0 0 0 529,51.3105 L687,51.3105 A0,0 0 0 0 687,51.3105 L687,36 L677,26 L529,26 A0,0 0 0 0 529,26 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M677,26 L677,36 L687,36 L677,26 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="535" y="43.5684">The account "admins"</text><g id="elem_GMN20"><path d="M223,992 L223,1063.2422 A0,0 0 0 0 223,1063.2422 L395,1063.2422 A0,0 0 0 0 395,1063.2422 L395,1031.5 L430.36,1027.5 L395,1023.5 L395,1002 L385,992 L223,992 A0,0 0 0 0 223,992 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M385,992 L385,1002 L395,1002 L385,992 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="229" y="1009.5684">a subject in the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="229" y="1024.8789">Gateway domain;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="229" y="1040.1895">also a domain shared to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="229" y="1055.5">authorised CLI clients</text></g><path d="M606.5,977 L606.5,993.3105 L565.5,1042.498 L606.5,1001.3105 L606.5,1017.6211 A0,0 0 0 0 606.5,1017.6211 L745.5,1017.6211 A0,0 0 0 0 745.5,1017.6211 L745.5,987 L735.5,977 L606.5,977 A0,0 0 0 0 606.5,977 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M735.5,977 L735.5,987 L745.5,987 L735.5,977 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="612.5" y="994.5684">entailed from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="612.5" y="1009.8789">Account.timesheet</text><path d="M606.5,1027.6211 L606.5,1043.9316 L564.5,1060.4863 L606.5,1051.9316 L606.5,1068.2422 A0,0 0 0 0 606.5,1068.2422 L743.5,1068.2422 A0,0 0 0 0 743.5,1068.2422 L743.5,1037.6211 L733.5,1027.6211 L606.5,1027.6211 A0,0 0 0 0 606.5,1027.6211 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M733.5,1027.6211 L733.5,1037.6211 L743.5,1037.6211 L733.5,1027.6211 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="612.5" y="1045.1895">Can only be set by</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="612.5" y="1060.5">account admin</text><g id="elem_GMN25"><path d="M98,508 L98,640.5 L63.36,644.5 L98,648.5 L98,780.9688 A0,0 0 0 0 98,780.9688 L448,780.9688 A0,0 0 0 0 448,780.9688 L448,518 L438,508 L98,508 A0,0 0 0 0 98,508 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M438,508 L438,518 L448,518 L438,508 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="55" x="104" y="525.5684">entailed</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" text-decoration="underline" textLength="31" x="163" y="525.5684">read</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="144" x="198" y="525.5684">access to a timesheet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="104" y="540.8789">(via Gateway export/publish)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="104" y="556.1895"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306" x="104" y="571.5">the user account must be the timesheet provider</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="13" x="104" y="586.8105">or</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="312" x="121" y="586.8105">the client of a project that contains the timesheet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="104" y="602.1211"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="104" y="617.4316">account</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="6" x="154" y="621.0645">u</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="164" y="617.4316">∈</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="112" y="635.7422">account</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="6" x="162" y="639.375">p</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="168" y="635.7422">.vf:primaryAccountable</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="104" y="654.0527">∨</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="104" y="669.3633">∃account</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="5" x="161" y="672.9961">c</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="166" y="669.3633">:Account ⦁</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="112" y="687.6738">account</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="6" x="162" y="691.3066">u</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="172" y="687.6738">∈</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="120" y="705.9844">account</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="5" x="170" y="709.6172">c</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="175" y="705.9844">.vf:primaryAccountable</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="112" y="724.2949">∧</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="112" y="739.6055">∃project:Project ⦁</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="120" y="754.916">project ∈ account</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="5" x="229" y="758.5488">c</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="234" y="754.916">.project ∧</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="120" y="773.2266">project ∈ timesheet.project</text></g><!--MD5=[3124add794188d75953438ffc4835d72]
class CLI--><g id="elem_CLI"><rect codeLine="90" fill="#F1F1F1" height="111.4414" id="CLI" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="171" x="778.5" y="589"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21" x="853.5" y="607.5352">CLI</text><line style="stroke:#181818;stroke-width:0.5;" x1="779.5" x2="948.5" y1="615.4883" y2="615.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151" x="784.5" y="633.0234">«secret» key : AuthKey</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="784.5" y="649.5117">userKey : UserKey</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="784.5" y="666">account</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="7" x="838.5" y="669.6328">u</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="159" x="784.5" y="685.4883">timesheets : domain [*]</text><line style="stroke:#181818;stroke-width:0.5;" x1="779.5" x2="948.5" y1="692.4414" y2="692.4414"/></g><g id="elem_GMN30"><path d="M554.5,609 L554.5,680.2422 A0,0 0 0 0 554.5,680.2422 L743.5,680.2422 A0,0 0 0 0 743.5,680.2422 L743.5,648.5 L778.15,644.5 L743.5,640.5 L743.5,619 L733.5,609 L554.5,609 A0,0 0 0 0 554.5,609 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M733.5,609 L733.5,619 L743.5,619 L733.5,609 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="560.5" y="626.5684">Installed on a device</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="560.5" y="641.8789">under an OS account.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="560.5" y="657.1895">Registered to user account</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="560.5" y="672.5">via keyid.</text></g><!--MD5=[033b72a131f47407b9f0b55998f42021]
class UserKey--><g id="elem_UserKey"><rect codeLine="116" fill="#F1F1F1" height="139.0625" id="UserKey" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="187" x="770.5" y="300"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="54" x="837" y="316.6016">«subject»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="836.5" y="332.668">UserKey</text><line style="stroke:#181818;stroke-width:0.5;" x1="771.5" x2="956.5" y1="340.6211" y2="340.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="776.5" y="358.1563">@id =</text><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="88" x="820.5" y="357.8076">".${keyid}"</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="776.5" y="374.6445">name? : string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="170" x="776.5" y="391.1328">publicKey : base64Binary</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="175" x="776.5" y="407.6211">privateKey : base64Binary</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129" x="776.5" y="424.1094">revoked? : boolean</text><line style="stroke:#181818;stroke-width:0.5;" x1="771.5" x2="956.5" y1="431.0625" y2="431.0625"/></g><path d="M992.5,292 L992.5,309.8105 L872.5,369.3535 L992.5,317.8105 L992.5,335.6211 A0,0 0 0 0 992.5,335.6211 L1150.5,335.6211 A0,0 0 0 0 1150.5,335.6211 L1150.5,302 L1140.5,292 L992.5,292 A0,0 0 0 0 992.5,292 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1140.5,292 L1140.5,302 L1150.5,302 L1140.5,292 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="998.5" y="309.5684">account</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="6" x="1048.5" y="313.2012">u</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="1054.5" y="309.5684">@≪gateway≫</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="998.5" y="327.8789">Not present in config</text><path d="M992.5,345.6211 L992.5,354.2764 L951.5,402.3301 L992.5,362.2764 L992.5,370.9316 A0,0 0 0 0 992.5,370.9316 L1162.5,370.9316 A0,0 0 0 0 1162.5,370.9316 L1162.5,355.6211 L1152.5,345.6211 L992.5,345.6211 A0,0 0 0 0 992.5,345.6211 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1152.5,345.6211 L1152.5,355.6211 L1162.5,355.6211 L1152.5,345.6211 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="998.5" y="363.1895">Encrypted with AuthKey</text><path d="M992.5,380.9316 L992.5,404.8975 L905.5,418.8184 L992.5,412.8975 L992.5,436.8633 A0,0 0 0 0 992.5,436.8633 L1167.5,436.8633 A0,0 0 0 0 1167.5,436.8633 L1167.5,390.9316 L1157.5,380.9316 L992.5,380.9316 A0,0 0 0 0 992.5,380.9316 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1157.5,380.9316 L1157.5,390.9316 L1167.5,390.9316 L1157.5,380.9316 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="998.5" y="398.5">possibly redundant</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="998.5" y="413.8105">with external keystore</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="998.5" y="429.1211">Assumed</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="32" x="1060.5" y="428.7974">true</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="1096.5" y="429.1211">in config</text><!--MD5=[169298fcae047c920cb45c646344fdd7]
class AuthKey--><g id="elem_AuthKey"><rect codeLine="138" fill="#F1F1F1" height="91.9531" id="AuthKey" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105" x="984.5" y="598.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="1008.5" y="617.0352">AuthKey</text><line style="stroke:#181818;stroke-width:0.5;" x1="985.5" x2="1088.5" y1="624.9883" y2="624.9883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88" x="990.5" y="642.5234">keyid : string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="990.5" y="659.0117">appid : string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="990.5" y="675.5">secret : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="985.5" x2="1088.5" y1="682.4531" y2="682.4531"/></g><g id="elem_GMN40"><path d="M1124.5,624 L1124.5,640.5 L1089.59,644.5 L1124.5,648.5 L1124.5,664.6211 A0,0 0 0 0 1124.5,664.6211 L1323.5,664.6211 A0,0 0 0 0 1323.5,664.6211 L1323.5,634 L1313.5,624 L1124.5,624 A0,0 0 0 0 1124.5,624 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1313.5,624 L1313.5,634 L1323.5,634 L1313.5,624 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="1130.5" y="641.5684">String-serialised "API key"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="1130.5" y="656.8789">Usable with Basic HTTP auth</text></g><!--MD5=[194d4a8dfc1f1dbb24ee205902653cbe]
reverse link Gateway to Account--><g id="link_Gateway_Account"><path codeLine="10" d="M438.2,241.72 C429.05,265.78 418.37,293.88 409.39,317.49 " fill="none" id="Gateway-backto-Account" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="442.82,229.55,436.9512,233.7401,438.5618,240.7691,444.4306,236.5789,442.82,229.55" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6" x="405.6948" y="306.7306">*</text></g><!--MD5=[f3ce057685e0ff9797995d99a96fc0ff]
link Account to Timesheet--><g id="link_Account_Timesheet"><path codeLine="25" d="M431.4781,431.9534 C431.4781,431.9534 458.36,482.03 466,508 C512.26,665.22 510.49,860.39 505.56,960.48 " fill="none" id="Account-Timesheet" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="504.87,973.67,509.339,964.8934,505.1337,968.677,501.3502,964.4716,504.87,973.67" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="505.1337" x2="505.555" y1="968.677" y2="960.69"/><polygon fill="#181818" points="425.31,421.66,424.9629,428.8627,431.4781,431.9534,431.8252,424.7507,425.31,421.66" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="374.5028" y="441.9095">provider</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6" x="498.9815" y="963.4176">*</text></g><!--MD5=[a1a4cfa532728efa24278c706b9245e3]
link Account to Project--><g id="link_Account_Project"><path codeLine="27" d="M286.8752,393.1888 C286.8752,393.1888 133.99,448.51 80,508 C56.27,534.15 45.02,573.15 39.7,602.6 " fill="none" id="Account-Project" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="37.6,615.79,42.9731,607.5359,38.3908,610.8529,35.0738,606.2706,37.6,615.79" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="38.3908" x2="39.645" y1="610.8529" y2="602.95"/><polygon fill="#181818" points="298.41,389.88,291.5397,387.6895,286.8752,393.1888,293.7455,395.3794,298.41,389.88" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="255.3987" y="388.4155">client</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6" x="31.5075" y="605.0645">*</text></g><!--MD5=[008ba0f0b6901373239fc7803ec7bfb5]
link UserAccount to Account--><g id="link_UserAccount_Account"><path codeLine="37" d="M584.46,231.17 C552.79,253.53 513.8,281.07 479.06,305.61 " fill="none" id="UserAccount-to-Account" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="482.77,311.55,462.4,317.37,474.69,300.12,482.77,311.55" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[3bd2f785ce7fba86ff840f78f2677824]
link OrganisationAccount to Account--><g id="link_OrganisationAccount_Account"><path codeLine="45" d="M343.54,80.09 C345.52,117.75 349.74,178.84 358,231 C361.46,252.83 366.45,276.34 371.47,297.64 " fill="none" id="OrganisationAccount-to-Account" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="378.31,296.17,376.24,317.26,364.71,299.48,378.31,296.17" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[3e3ddf26659482ebc6db1edb96e472ec]
reverse link OrganisationAccount to UserAccount--><g id="link_OrganisationAccount_UserAccount"><path codeLine="46" d="M437.23,85.39 C475.58,102.18 520.09,122.09 560,141 C565.66,143.68 571.5,146.51 577.35,149.38 " fill="none" id="OrganisationAccount-backto-UserAccount" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="425.01,80.05,428.9029,86.12,436.0033,84.8612,432.1104,78.7912,425.01,80.05" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22" x="547.411" y="142.6404">1..*</text></g><!--MD5=[c52c4d9618aad4a60bea30b2d0498325]
link Project to Timesheet--><g id="link_Project_Timesheet"><path codeLine="88" d="M38.32,673.2 C43.1,702.72 54.36,749.45 80,781 C187.64,913.45 264.72,887.75 412,974 C417.88,977.44 423.98,981.02 430.1,984.62 " fill="none" id="Project-Timesheet" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6" x="32.386" y="693.3057">*</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6" x="416.4791" y="977.0228">*</text></g><!--MD5=[30331c57f26e5658c626cedbd9e8624f]
link UserKey to CLI--><g id="link_UserKey_CLI"><path codeLine="103" d="M864,439.04 C864,485.31 864,545.59 864,588.68 " fill="none" id="UserKey-CLI" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/></g><!--MD5=[7eae40f39ba8424a7eed7bbcb9b34095]
link CLI to Timesheet--><g id="link_CLI_Timesheet"><path codeLine="105" d="M825.59,700.2 C807.01,725.55 783.81,755.61 761,781 C698.9,850.11 620.55,922.32 566.17,970.38 " fill="none" id="CLI-to-Timesheet" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="562.3,973.8,571.6898,970.8282,566.0433,970.4853,566.3862,964.8388,562.3,973.8" style="stroke:#181818;stroke-width:1.0;"/><path d="M732,816 L732,939 L1059,939 L1059,826 L1049,816 L732,816 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1049,816 L1049,826 L1059,826 L1049,816 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="55" x="738" y="833.5684">entailed</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" text-decoration="underline" textLength="99" x="797" y="833.5684">read and write</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="44" x="900" y="833.5684">access</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="738" y="848.8789">(via the CLI)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="738" y="864.1895"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306" x="738" y="879.5">the user account must be the timesheet provider</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="738" y="894.8105"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="738" y="910.1211">account</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="6" x="788" y="913.7539">u</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="798" y="910.1211">∈</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="746" y="928.4316">account</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="6" x="796" y="932.0645">p</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="802" y="928.4316">.vf:primaryAccountable</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6" x="564.1341" y="963.1836">*</text></g><!--MD5=[da11c875fea71f40e71ed49095cfc482]
reverse link UserAccount to UserKey--><g id="link_UserAccount_UserKey"><path codeLine="136" d="M709.92,239.62 C732.45,258.47 758.19,280 782.09,299.99 " fill="none" id="UserAccount-backto-UserKey" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="699.81,231.17,701.845,238.088,709.0135,238.8704,706.9785,231.9523,699.81,231.17" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="698.6739" y="251.1952">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6" x="766.803" y="289.149">*</text></g><!--MD5=[12fb81e7e431a8bed8552b36b177e9b4]
link CLI to AuthKey--><g id="link_CLI_AuthKey"><path codeLine="147" d="M949.82,644.5 C961.29,644.5 972.75,644.5 984.22,644.5 " fill="none" id="CLI-AuthKey" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[135bf3b8e2b3a959567973e31b43e156]
@startuml
'https://plantuml.com/class-diagram

hide circle
allowmixing

class Gateway <<domain>> <<service>> {
  appMasterKey <<secret>>
}

Gateway *- - "*" Account

class Account <<abstract>> <<subject>> {
  timesheet : Timesheet [*]
  project : Project [*]
}
note right of Account::timesheet
  inverse injection: a Timesheet
  can only appear in one Account
end note
note right of Account::project
  inverse injection: a Project
  can only appear in one Account
end note

Account "provider" *- -> "*" Timesheet

Account "client" *- -> "*" Project

class UserAccount <<subject>> {
  email : string [1..*]
  key : UserKey [*]
}
note right of UserAccount::email
  Registered email, used
  for account activation
end note
UserAccount - -|> Account

class OrganisationAccount <<subject>> {
  vf:primaryAccountable : UserAccount [1..*]
}
note right of OrganisationAccount::vf:primaryAccountable
  The account "admins"
end note
OrganisationAccount - -|> Account
OrganisationAccount o- - "1..*" UserAccount

class Timesheet <<domain>> <<subject>> {
  //account<sub>p</sub> : Account//
  project : Project [*]
}
note left of Timesheet
  a subject in the
  Gateway domain;
  also a domain shared to
  authorised CLI clients
end note
note right of Timesheet::account
  entailed from
  Account.timesheet
end note
note right of Timesheet::project
  Can only be set by
  account admin
end note

class Project <<subject>> {
}
note right of Project
  **entailed __read__ access to a timesheet**
  (via Gateway export/publish)

  the user account must be the timesheet provider
  //or// the client of a project that contains the timesheet

  account<sub>u</sub> ∈
    account<sub>p</sub>.vf:primaryAccountable
  ∨
  ∃account<sub>c</sub>:Account ⦁
    account<sub>u</sub> ∈
      account<sub>c</sub>.vf:primaryAccountable
    ∧
    ∃project:Project ⦁
      project ∈ account<sub>c</sub>.project ∧
      project ∈ timesheet.project
end note

Project "*" - - "*" Timesheet

class CLI {
  <<secret>> key : AuthKey
  userKey : UserKey
  account<sub>u</sub>
  timesheets : domain [*]
}
note left of CLI
  Installed on a device
  under an OS account.
  Registered to user account
  via keyid.
end note

UserKey .. CLI

CLI ..> "*" Timesheet
note bottom on link
  **entailed __read and write__ access**
  (via the CLI)

  the user account must be the timesheet provider

  account<sub>u</sub> ∈
    account<sub>p</sub>.vf:primaryAccountable
end note

class UserKey <<subject>> {
  @id = """.${keyid}" ""
  name? : string
  publicKey : base64Binary
  privateKey : base64Binary
  revoked? : boolean
}
note right of UserKey::name
  account<sub>u</sub>@≪gateway≫
  Not present in config
end note
note right of UserKey::privateKey
  Encrypted with AuthKey
end note
note right of UserKey::revoked
  possibly redundant
  with external keystore
  Assumed ""true"" in config
end note

UserAccount "1" *- - "*" UserKey

class AuthKey {
  keyid : string
  appid : string
  secret : string
}
note right of AuthKey
  String-serialised "API key"
  Usable with Basic HTTP auth
end note
CLI - AuthKey

@enduml

@startuml

hide circle
allowmixing

class Gateway <<domain>> <<service>> {
  appMasterKey <<secret>>
}

Gateway *- - "*" Account

class Account <<abstract>> <<subject>> {
  timesheet : Timesheet [*]
  project : Project [*]
}
note right of Account::timesheet
  inverse injection: a Timesheet
  can only appear in one Account
end note
note right of Account::project
  inverse injection: a Project
  can only appear in one Account
end note

Account "provider" *- -> "*" Timesheet

Account "client" *- -> "*" Project

class UserAccount <<subject>> {
  email : string [1..*]
  key : UserKey [*]
}
note right of UserAccount::email
  Registered email, used
  for account activation
end note
UserAccount - -|> Account

class OrganisationAccount <<subject>> {
  vf:primaryAccountable : UserAccount [1..*]
}
note right of OrganisationAccount::vf:primaryAccountable
  The account "admins"
end note
OrganisationAccount - -|> Account
OrganisationAccount o- - "1..*" UserAccount

class Timesheet <<domain>> <<subject>> {
  //account<sub>p</sub> : Account//
  project : Project [*]
}
note left of Timesheet
  a subject in the
  Gateway domain;
  also a domain shared to
  authorised CLI clients
end note
note right of Timesheet::account
  entailed from
  Account.timesheet
end note
note right of Timesheet::project
  Can only be set by
  account admin
end note

class Project <<subject>> {
}
note right of Project
  **entailed __read__ access to a timesheet**
  (via Gateway export/publish)

  the user account must be the timesheet provider
  //or// the client of a project that contains the timesheet

  account<sub>u</sub> ∈
    account<sub>p</sub>.vf:primaryAccountable
  ∨
  ∃account<sub>c</sub>:Account ⦁
    account<sub>u</sub> ∈
      account<sub>c</sub>.vf:primaryAccountable
    ∧
    ∃project:Project ⦁
      project ∈ account<sub>c</sub>.project ∧
      project ∈ timesheet.project
end note

Project "*" - - "*" Timesheet

class CLI {
  <<secret>> key : AuthKey
  userKey : UserKey
  account<sub>u</sub>
  timesheets : domain [*]
}
note left of CLI
  Installed on a device
  under an OS account.
  Registered to user account
  via keyid.
end note

UserKey .. CLI

CLI ..> "*" Timesheet
note bottom on link
  **entailed __read and write__ access**
  (via the CLI)

  the user account must be the timesheet provider

  account<sub>u</sub> ∈
    account<sub>p</sub>.vf:primaryAccountable
end note

class UserKey <<subject>> {
  @id = """.${keyid}" ""
  name? : string
  publicKey : base64Binary
  privateKey : base64Binary
  revoked? : boolean
}
note right of UserKey::name
  account<sub>u</sub>@≪gateway≫
  Not present in config
end note
note right of UserKey::privateKey
  Encrypted with AuthKey
end note
note right of UserKey::revoked
  possibly redundant
  with external keystore
  Assumed ""true"" in config
end note

UserAccount "1" *- - "*" UserKey

class AuthKey {
  keyid : string
  appid : string
  secret : string
}
note right of AuthKey
  String-serialised "API key"
  Usable with Basic HTTP auth
end note
CLI - AuthKey

@enduml

PlantUML version 1.2022.8(Sun Sep 25 10:00:33 BST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>