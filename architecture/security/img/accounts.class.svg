<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="960px" preserveAspectRatio="none" style="width:1286px;height:960px;background:#FFFFFF;" version="1.1" viewBox="0 0 1286 960" width="1286px" zoomAndPan="magnify"><defs><filter height="300%" id="f1kow9cplezdub" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[1a43f3003f8c278f89cc52af821a1f32]
cluster Ably--><polygon fill="#FFFFFF" filter="url(#f1kow9cplezdub)" points="537.5,258,575.5,258,582.5,280.4883,847.5,280.4883,847.5,429,537.5,429,537.5,258" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="537.5" x2="582.5" y1="280.4883" y2="280.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="32" x="541.5" y="273.5352">Ably</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="61" x="666" y="296.0234">«service»</text><!--MD5=[cd8aea8b05f456e5d12ddf6e2609affc]
class AblyKey--><rect codeLine="126" fill="#FEFECE" filter="url(#f1kow9cplezdub)" height="91.9531" id="AblyKey" style="stroke:#A80036;stroke-width:1.5;" width="113" x="718" y="315"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="46" x="751.5" y="331.6016">AblyKey</text><line style="stroke:#A80036;stroke-width:1.5;" x1="719" x2="830" y1="339.1328" y2="339.1328"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="28" x="724" y="353.7676">keyid</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="29" x="724" y="366.7227">name</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="33" x="724" y="379.6777">secret</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="101" x="724" y="392.6328">capabilities : string</text><line style="stroke:#A80036;stroke-width:1.5;" x1="719" x2="830" y1="398.9531" y2="398.9531"/><path d="M554,309 L554,337.3105 A0,0 0 0 0 554,337.3105 L631,337.3105 A0,0 0 0 0 631,337.3105 L631,327.1553 L722,362.5654 L631,319.1553 L631,319 L621,309 L554,309 A0,0 0 0 0 554,309 " fill="#FBFB77" filter="url(#f1kow9cplezdub)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M621,309 L621,319 L631,319 L621,309 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="560" y="326.5684">account</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="6" x="610" y="330.2012">u</text><path d="M554,347.3105 L554,403.2422 A0,0 0 0 0 554,403.2422 L683,403.2422 A0,0 0 0 0 683,403.2422 L683,379.2764 L722,388.4756 L683,371.2764 L683,357.3105 L673,347.3105 L554,347.3105 A0,0 0 0 0 554,347.3105 " fill="#FBFB77" filter="url(#f1kow9cplezdub)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M673,347.3105 L673,357.3105 L683,357.3105 L673,347.3105 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="560" y="364.8789">Defines channel</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="560" y="380.1895">access and thus,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="560" y="395.5">timesheet access</text><!--MD5=[6de492f04047ff8a778df2bea690e363]
class Gateway--><rect codeLine="6" fill="#FEFECE" filter="url(#f1kow9cplezdub)" height="95.4863" id="Gateway" style="stroke:#A80036;stroke-width:1.5;" width="135" x="351" y="111"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="55" x="391" y="127.6016">«domain»</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="63" x="387" y="141.7344">«ably app»</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="52" x="392.5" y="155.8672">«service»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="49" x="394" y="170">Gateway</text><line style="stroke:#A80036;stroke-width:1.5;" x1="352" x2="485" y1="177.5313" y2="177.5313"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="123" x="357" y="192.166">appMasterKey «secret»</text><line style="stroke:#A80036;stroke-width:1.5;" x1="352" x2="485" y1="198.4863" y2="198.4863"/><!--MD5=[f9a29335b499db729be669fd1bd54958]
class Account--><rect codeLine="12" fill="#FEFECE" filter="url(#f1kow9cplezdub)" height="107.2637" id="Account" style="stroke:#A80036;stroke-width:1.5;" width="242" x="276.5" y="307.5"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="59" x="368" y="324.1016">«abstract»</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="54" x="370.5" y="338.2344">«subject»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="45" x="375" y="352.3672">Account</text><line style="stroke:#A80036;stroke-width:1.5;" x1="277.5" x2="517.5" y1="359.8984" y2="359.8984"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="230" x="282.5" y="374.5332">vf:primaryAccountable : UserAccount [1..*]</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="132" x="282.5" y="387.4883">timesheet : Timesheet [*]</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="100" x="282.5" y="400.4434">project : Project [*]</text><line style="stroke:#A80036;stroke-width:1.5;" x1="277.5" x2="517.5" y1="406.7637" y2="406.7637"/><path d="M6,270 L6,341.2422 A0,0 0 0 0 6,341.2422 L241,341.2422 A0,0 0 0 0 241,341.2422 L241,309.6211 L280.5,370.376 L241,301.6211 L241,280 L231,270 L6,270 A0,0 0 0 0 6,270 " fill="#FBFB77" filter="url(#f1kow9cplezdub)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M231,270 L231,280 L241,280 L231,270 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="12" y="287.5684">The account "admin".</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="12" y="302.8789">For user accounts, a</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="20" y="318.1895">redundant self-reference</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206" x="20" y="333.5">(user admins their own account).</text><path d="M6,351.2422 L6,391.8633 A0,0 0 0 0 6,391.8633 L225,391.8633 A0,0 0 0 0 225,391.8633 L225,375.5527 L280.5,383.3311 L225,367.5527 L225,361.2422 L215,351.2422 L6,351.2422 A0,0 0 0 0 6,351.2422 " fill="#FBFB77" filter="url(#f1kow9cplezdub)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M215,351.2422 L215,361.2422 L225,361.2422 L215,351.2422 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="12" y="368.8105">inverse injection: a Timesheet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="12" y="384.1211">can only appear in one Account</text><path d="M6,401.8633 L6,442.4844 A0,0 0 0 0 6,442.4844 L225,442.4844 A0,0 0 0 0 225,442.4844 L225,426.1738 L280.5,396.2861 L225,418.1738 L225,411.8633 L215,401.8633 L6,401.8633 A0,0 0 0 0 6,401.8633 " fill="#FBFB77" filter="url(#f1kow9cplezdub)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M215,401.8633 L215,411.8633 L225,411.8633 L215,401.8633 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="12" y="419.4316">inverse injection: a Project</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="12" y="434.7422">can only appear in one Account</text><!--MD5=[0c2e12f724a2bba325ddf189ef351421]
class Timesheet--><rect codeLine="55" fill="#FEFECE" filter="url(#f1kow9cplezdub)" height="97.3086" id="Timesheet" style="stroke:#A80036;stroke-width:1.5;" width="114" x="806.5" y="849"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="55" x="836" y="865.6016">«domain»</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="54" x="836.5" y="879.7344">«subject»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="60" x="833.5" y="893.8672">Timesheet</text><line style="stroke:#A80036;stroke-width:1.5;" x1="807.5" x2="919.5" y1="901.3984" y2="901.3984"/><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacing" textLength="43" x="812.5" y="916.0332">account</text><text fill="#000000" font-family="sans-serif" font-size="8" font-style="italic" lengthAdjust="spacing" textLength="5" x="855.5" y="919.0879">p</text><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacing" textLength="51" x="863.5" y="916.0332">: Account</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="100" x="812.5" y="931.9883">project : Project [*]</text><line style="stroke:#A80036;stroke-width:1.5;" x1="807.5" x2="919.5" y1="938.3086" y2="938.3086"/><!--MD5=[79d378210367c0c6ec62ef762ddfbd1b]
class Project--><rect codeLine="74" fill="#FEFECE" filter="url(#f1kow9cplezdub)" height="54.2656" id="Project" style="stroke:#A80036;stroke-width:1.5;" width="56" x="369.5" y="622.5"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="54" x="370.5" y="639.1016">«subject»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="40" x="377.5" y="653.2344">Project</text><line style="stroke:#A80036;stroke-width:1.5;" x1="370.5" x2="424.5" y1="660.7656" y2="660.7656"/><line style="stroke:#A80036;stroke-width:1.5;" x1="370.5" x2="424.5" y1="668.7656" y2="668.7656"/><!--MD5=[873670755c6433d3512a8b316aa6820d]
class UserAccount--><rect codeLine="36" fill="#FEFECE" filter="url(#f1kow9cplezdub)" height="66.043" id="UserAccount" style="stroke:#A80036;stroke-width:1.5;" width="110" x="719.5" y="125.5"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="71" x="739" y="142.1016">UserAccount</text><line style="stroke:#A80036;stroke-width:1.5;" x1="720.5" x2="828.5" y1="149.6328" y2="149.6328"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="98" x="725.5" y="164.2676">email : string [1..*]</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="85" x="725.5" y="177.2227">keyid : string [*]</text><line style="stroke:#A80036;stroke-width:1.5;" x1="720.5" x2="828.5" y1="183.543" y2="183.543"/><path d="M521,108 L521,148.6211 A0,0 0 0 0 521,148.6211 L684,148.6211 A0,0 0 0 0 684,148.6211 L684,132.3105 L723.5,160.1104 L684,124.3105 L684,118 L674,108 L521,108 A0,0 0 0 0 521,108 " fill="#FBFB77" filter="url(#f1kow9cplezdub)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M674,108 L674,118 L684,118 L674,108 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="527" y="125.5684">Registered email, used</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="527" y="140.8789">for account activation</text><path d="M521,158.6211 L521,199.2422 A0,0 0 0 0 521,199.2422 L662,199.2422 A0,0 0 0 0 662,199.2422 L662,182.9316 L723.5,173.0654 L662,174.9316 L662,168.6211 L652,158.6211 L521,158.6211 A0,0 0 0 0 521,158.6211 " fill="#FBFB77" filter="url(#f1kow9cplezdub)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M652,158.6211 L652,168.6211 L662,168.6211 L652,158.6211 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="527" y="176.1895">Matches</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="64" x="583" y="175.8657">ably.key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="527" y="191.5">Can be revoked</text><!--MD5=[f5f68a7b4d1daa3f868d0f655b773560]
class OrganisationAccount--><rect codeLine="50" fill="#FEFECE" filter="url(#f1kow9cplezdub)" height="40.1328" id="OrganisationAccount" style="stroke:#A80036;stroke-width:1.5;" width="123" x="256" y="7"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="117" x="259" y="23.6016">OrganisationAccount</text><line style="stroke:#A80036;stroke-width:1.5;" x1="257" x2="378" y1="31.1328" y2="31.1328"/><line style="stroke:#A80036;stroke-width:1.5;" x1="257" x2="378" y1="39.1328" y2="39.1328"/><path d="M599.5,862 L599.5,933.2422 A0,0 0 0 0 599.5,933.2422 L771.5,933.2422 A0,0 0 0 0 771.5,933.2422 L771.5,901.5 L806.5,897.5 L771.5,893.5 L771.5,872 L761.5,862 L599.5,862 A0,0 0 0 0 599.5,862 " fill="#FBFB77" filter="url(#f1kow9cplezdub)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M761.5,862 L761.5,872 L771.5,872 L761.5,862 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="605.5" y="879.5684">a subject in the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="605.5" y="894.8789">Gateway domain;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="605.5" y="910.1895">also a domain shared to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="605.5" y="925.5">authorised CLI clients</text><path d="M956,847 L956,863.3105 L914.5,913.376 L956,871.3105 L956,887.6211 A0,0 0 0 0 956,887.6211 L1095,887.6211 A0,0 0 0 0 1095,887.6211 L1095,857 L1085,847 L956,847 A0,0 0 0 0 956,847 " fill="#FBFB77" filter="url(#f1kow9cplezdub)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1085,847 L1085,857 L1095,857 L1085,847 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="962" y="864.5684">entailed from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="962" y="879.8789">Account.timesheet</text><path d="M956,897.6211 L956,913.9316 L912.5,927.8311 L956,921.9316 L956,938.2422 A0,0 0 0 0 956,938.2422 L1093,938.2422 A0,0 0 0 0 1093,938.2422 L1093,907.6211 L1083,897.6211 L956,897.6211 A0,0 0 0 0 956,897.6211 " fill="#FBFB77" filter="url(#f1kow9cplezdub)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1083,897.6211 L1083,907.6211 L1093,907.6211 L1083,897.6211 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="962" y="915.1895">Can only be set by</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="962" y="930.5">account admin</text><path d="M460.5,513 L460.5,645.5 L425.86,649.5 L460.5,653.5 L460.5,785.9688 A0,0 0 0 0 460.5,785.9688 L810.5,785.9688 A0,0 0 0 0 810.5,785.9688 L810.5,523 L800.5,513 L460.5,513 A0,0 0 0 0 460.5,513 " fill="#FBFB77" filter="url(#f1kow9cplezdub)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M800.5,513 L800.5,523 L810.5,523 L800.5,513 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="55" x="466.5" y="530.5684">entailed</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" text-decoration="underline" textLength="31" x="525.5" y="530.5684">read</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="144" x="560.5" y="530.5684">access to a timesheet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="466.5" y="545.8789">(via Gateway export/publish)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="470.5" y="561.1895"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306" x="466.5" y="576.5">the user account must be the timesheet provider</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="13" x="466.5" y="591.8105">or</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="312" x="483.5" y="591.8105">the client of a project that contains the timesheet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="470.5" y="607.1211"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="466.5" y="622.4316">account</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="6" x="516.5" y="626.0645">u</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="526.5" y="622.4316">∈</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="474.5" y="640.7422">account</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="6" x="524.5" y="644.375">p</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="530.5" y="640.7422">.vf:primaryAccountable</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="466.5" y="659.0527">∨</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="466.5" y="674.3633">∃account</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="5" x="523.5" y="677.9961">c</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="528.5" y="674.3633">:Account ⦁</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="474.5" y="692.6738">account</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="6" x="524.5" y="696.3066">u</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="534.5" y="692.6738">∈</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="482.5" y="710.9844">account</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="5" x="532.5" y="714.6172">c</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="537.5" y="710.9844">.vf:primaryAccountable</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="474.5" y="729.2949">∧</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="474.5" y="744.6055">∃project:Project ⦁</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="482.5" y="759.916">project ∈ account</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="5" x="591.5" y="763.5488">c</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="596.5" y="759.916">.project ∧</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="482.5" y="778.2266">project ∈ timesheet.project</text><!--MD5=[df6a39b053164d23cc3ecae9c3484a54]
entity CLI--><rect fill="#FEFECE" filter="url(#f1kow9cplezdub)" height="123.4414" style="stroke:#A80036;stroke-width:1.5;" width="199" x="866" y="299.5"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="1045" y="304.5"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="1043" y="306.5"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="1043" y="310.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21" x="881" y="333.0352">CLI</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="885" y="349.5234"/><line style="stroke:#A80036;stroke-width:1.0;" x1="867" x2="1064" y1="352.4766" y2="352.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114" x="881" y="370.0117">ably.key «secret»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="881" y="386.5">account</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="7" x="935" y="390.1328">u</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="946" y="386.5">(aka user)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="159" x="881" y="405.9883">timesheets : domain [*]</text><path d="M871,123 L871,194.2422 A0,0 0 0 0 871,194.2422 L961.5,194.2422 L965.5,299.15 L969.5,194.2422 L1060,194.2422 A0,0 0 0 0 1060,194.2422 L1060,133 L1050,123 L871,123 A0,0 0 0 0 871,123 " fill="#FBFB77" filter="url(#f1kow9cplezdub)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1050,123 L1050,133 L1060,133 L1050,123 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="877" y="140.5684">Installed on a device</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="877" y="155.8789">under an OS account.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="877" y="171.1895">Registered to user account</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="877" y="186.5">via ably.key.</text><!--MD5=[194d4a8dfc1f1dbb24ee205902653cbe]
reverse link Gateway to Account--><path codeLine="10" d="M412.24,219.29 C409.3,247.29 405.84,280.35 403.01,307.39 " fill="none" id="Gateway-backto-Account" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="413.63,206,409.0255,211.5496,412.3772,217.9344,416.9817,212.3848,413.63,206" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6" x="397.3473" y="296.7499">*</text><!--MD5=[f505804a0bb9275518c7372a2126ee0f]
link Account$$$LEFT to Account--><!--MD5=[f3ce057685e0ff9797995d99a96fc0ff]
link Account to Timesheet--><path codeLine="32" d="M478.6242,421.1363 C478.6242,421.1363 517.91,443.97 537.5,452 C659.77,502.12 740.61,414.32 828.5,513 C869.7,559.27 869.59,739.54 866.39,835.54 " fill="none" id="Account-Timesheet" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="865.91,848.79,870.2335,839.9409,866.0912,843.7933,862.2388,839.651,865.91,848.79" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="866.0912" x2="866.38" y1="843.7933" y2="835.795"/><polygon fill="#A80036" points="468.49,414.71,471.415,421.3012,478.6242,421.1363,475.6992,414.5451,468.49,414.71" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="422.5355" y="435.5066">provider</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6" x="859.8233" y="838.1027">*</text><!--MD5=[a1a4cfa532728efa24278c706b9245e3]
link Account to Project--><path codeLine="34" d="M397.5,426.55 C397.5,426.55 397.5,562.63 397.5,609.35 " fill="none" id="Account-Project" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="397.5,622.48,401.5,613.48,397.5,617.48,393.5,613.48,397.5,622.48" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="397.5" x2="397.5" y1="617.48" y2="609.48"/><polygon fill="#A80036" points="397.5,414.55,393.5,420.55,397.5,426.55,401.5,420.55,397.5,414.55" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="360.1484" y="435.3251">client</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6" x="390.7688" y="611.6396">*</text><!--MD5=[59bfd3b9fcea3a5880a303d33fa5646b]
link UserAccount$$$LEFT to UserAccount--><!--MD5=[008ba0f0b6901373239fc7803ec7bfb5]
link UserAccount to Account--><path codeLine="48" d="M732.35,191.71 C722.59,198.12 711.98,204.31 701.5,209 C632.91,239.66 604.97,216.95 537.5,250 C513.62,261.7 489.97,277.96 469.11,294.39 " fill="none" id="UserAccount-to-Account" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="473.3,300.01,453.38,307.22,464.45,289.16,473.3,300.01" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[3bd2f785ce7fba86ff840f78f2677824]
link OrganisationAccount to Account--><path codeLine="52" d="M317.25,47.08 C317.23,80.44 319.1,151.3 333.5,209 C340.2,235.84 351.03,264.05 361.89,288.73 " fill="none" id="OrganisationAccount-to-Account" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="368.4,286.14,370.33,307.25,355.66,291.95,368.4,286.14" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[3e3ddf26659482ebc6db1edb96e472ec]
reverse link OrganisationAccount to UserAccount--><path codeLine="53" d="M392.49,34.89 C471.83,44.16 599.4,64.76 701.5,108 C712.36,112.6 723.29,118.91 733.26,125.49 " fill="none" id="OrganisationAccount-backto-UserAccount" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#FFFFFF" points="379.22,33.4,384.7337,38.0475,391.1443,34.7454,385.6306,30.0979,379.22,33.4" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22" x="700.4855" y="114.7308">1..*</text><!--MD5=[f59287a37ea7426887cc54bb6a33788a]
link Timesheet to Timesheet$$$RIGHT--><!--MD5=[c52c4d9618aad4a60bea30b2d0498325]
link Project to Timesheet--><path codeLine="95" d="M398.5,676.51 C401.17,707.45 410.51,758.38 442.5,786 C561.04,888.32 644.19,788.66 789.5,847 C795.09,849.25 800.7,851.96 806.19,854.94 " fill="none" id="Project-Timesheet" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6" x="392.0125" y="697.4956">*</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6" x="792.4628" y="846.0945">*</text><!--MD5=[3171026a460a65b82e10f3eaa254fce8]
link UserAccount to CLI--><path codeLine="112" d="M805.19,191.71 C832.71,220.61 873.83,263.77 907.54,299.15 " fill="none" id="UserAccount-CLI" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6" x="894.4915" y="288.6922">*</text><!--MD5=[7eae40f39ba8424a7eed7bbcb9b34095]
link CLI to Timesheet--><path codeLine="114" d="M958.33,422.57 C947.29,510.33 923.73,677.58 889.5,817 C887.34,825.81 884.68,835.04 881.91,843.98 " fill="none" id="CLI-to-Timesheet" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="880.35,848.91,886.8713,841.5295,881.8536,844.1414,879.2416,839.1237,880.35,848.91" style="stroke:#A80036;stroke-width:1.0;"/><path d="M950.5,586 L950.5,709 L1277.5,709 L1277.5,596 L1267.5,586 L950.5,586 " fill="#FBFB77" filter="url(#f1kow9cplezdub)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1267.5,586 L1267.5,596 L1277.5,596 L1267.5,586 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="55" x="956.5" y="603.5684">entailed</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" text-decoration="underline" textLength="99" x="1015.5" y="603.5684">read and write</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="44" x="1118.5" y="603.5684">access</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="956.5" y="618.8789">(via the CLI)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="960.5" y="634.1895"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306" x="956.5" y="649.5">the user account must be the timesheet provider</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="960.5" y="664.8105"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="956.5" y="680.1211">account</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="6" x="1006.5" y="683.7539">u</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="1016.5" y="680.1211">∈</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="964.5" y="698.4316">account</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="6" x="1014.5" y="702.0645">p</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="1020.5" y="698.4316">.vf:primaryAccountable</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6" x="876.3842" y="838.2403">*</text><!--MD5=[aaa4b569874f2939ef51bf111c950107]
link AblyKey$$$LEFT to AblyKey--><!--MD5=[601a963235cfb799dd4c132aab4bc84f]
link UserAccount to AblyKey--><path codeLine="141" d="M774.5,191.71 C774.5,225.03 774.5,277.34 774.5,314.79 " fill="none" id="UserAccount-AblyKey" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="765.7375" y="212.0642">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6" x="768.0406" y="304.1614">*</text><!--MD5=[1c648ae00f95d54faf72ebbf5b54bc76]
@startuml
'https://plantuml.com/class-diagram

hide circle
allowmixing

class Gateway <<domain>> <<ably app>> <<service>> {
  appMasterKey <<secret>>
}

Gateway *- - "*" Account

class Account <<abstract>> <<subject>> {
  vf:primaryAccountable : UserAccount [1..*]
  timesheet : Timesheet [*]
  project : Project [*]
}
note left of Account::vf:primaryAccountable
  The account "admin".
  For user accounts, a
    redundant self-reference
    (user admins their own account).
end note
note left of Account::timesheet
  inverse injection: a Timesheet
  can only appear in one Account
end note
note left of Account::project
  inverse injection: a Project
  can only appear in one Account
end note

Account "provider" *- -> "*" Timesheet

Account "client" *- -> "*" Project

class UserAccount {
  email : string [1..*]
  keyid : string [*]
}
note left of UserAccount::email
  Registered email, used
  for account activation
end note
note left of UserAccount::keyid
  Matches ""ably.key""
  Can be revoked
end note
UserAccount - -|> Account

class OrganisationAccount {
}
OrganisationAccount - -|> Account
OrganisationAccount o- - "1..*" UserAccount

class Timesheet <<domain>> <<subject>> {
  //account<sub>p</sub> : Account//
  project : Project [*]
}
note left of Timesheet
  a subject in the
  Gateway domain;
  also a domain shared to
  authorised CLI clients
end note
note right of Timesheet::account
  entailed from
  Account.timesheet
end note
note right of Timesheet::project
  Can only be set by
  account admin
end note

class Project <<subject>> {
}
note right of Project
  **entailed __read__ access to a timesheet**
  (via Gateway export/publish)

  the user account must be the timesheet provider
  //or// the client of a project that contains the timesheet

  account<sub>u</sub> ∈
    account<sub>p</sub>.vf:primaryAccountable
  ∨
  ∃account<sub>c</sub>:Account ⦁
    account<sub>u</sub> ∈
      account<sub>c</sub>.vf:primaryAccountable
    ∧
    ∃project:Project ⦁
      project ∈ account<sub>c</sub>.project ∧
      project ∈ timesheet.project
end note

Project "*" - - "*" Timesheet

component CLI [
  CLI

  - - -
  ably.key <<secret>>
  account<sub>u</sub> (aka user)
  timesheets : domain [*]
]
note top of CLI
  Installed on a device
  under an OS account.
  Registered to user account
  via ably.key.
end note

UserAccount .. "*" CLI

CLI ..> "*" Timesheet
note bottom on link
  **entailed __read and write__ access**
  (via the CLI)

  the user account must be the timesheet provider

  account<sub>u</sub> ∈
    account<sub>p</sub>.vf:primaryAccountable
end note

package Ably <<service>> {
  class AblyKey {
    keyid
    name
    secret
    capabilities : string
  }
  note left of AblyKey::name
    account<sub>u</sub>
  end note
  note left of AblyKey::capabilities
    Defines channel
    access and thus,
    timesheet access
  end note

  UserAccount "1" - - "*" AblyKey
}

@enduml

@startuml

hide circle
allowmixing

class Gateway <<domain>> <<ably app>> <<service>> {
  appMasterKey <<secret>>
}

Gateway *- - "*" Account

class Account <<abstract>> <<subject>> {
  vf:primaryAccountable : UserAccount [1..*]
  timesheet : Timesheet [*]
  project : Project [*]
}
note left of Account::vf:primaryAccountable
  The account "admin".
  For user accounts, a
    redundant self-reference
    (user admins their own account).
end note
note left of Account::timesheet
  inverse injection: a Timesheet
  can only appear in one Account
end note
note left of Account::project
  inverse injection: a Project
  can only appear in one Account
end note

Account "provider" *- -> "*" Timesheet

Account "client" *- -> "*" Project

class UserAccount {
  email : string [1..*]
  keyid : string [*]
}
note left of UserAccount::email
  Registered email, used
  for account activation
end note
note left of UserAccount::keyid
  Matches ""ably.key""
  Can be revoked
end note
UserAccount - -|> Account

class OrganisationAccount {
}
OrganisationAccount - -|> Account
OrganisationAccount o- - "1..*" UserAccount

class Timesheet <<domain>> <<subject>> {
  //account<sub>p</sub> : Account//
  project : Project [*]
}
note left of Timesheet
  a subject in the
  Gateway domain;
  also a domain shared to
  authorised CLI clients
end note
note right of Timesheet::account
  entailed from
  Account.timesheet
end note
note right of Timesheet::project
  Can only be set by
  account admin
end note

class Project <<subject>> {
}
note right of Project
  **entailed __read__ access to a timesheet**
  (via Gateway export/publish)

  the user account must be the timesheet provider
  //or// the client of a project that contains the timesheet

  account<sub>u</sub> ∈
    account<sub>p</sub>.vf:primaryAccountable
  ∨
  ∃account<sub>c</sub>:Account ⦁
    account<sub>u</sub> ∈
      account<sub>c</sub>.vf:primaryAccountable
    ∧
    ∃project:Project ⦁
      project ∈ account<sub>c</sub>.project ∧
      project ∈ timesheet.project
end note

Project "*" - - "*" Timesheet

component CLI [
  CLI

  - - -
  ably.key <<secret>>
  account<sub>u</sub> (aka user)
  timesheets : domain [*]
]
note top of CLI
  Installed on a device
  under an OS account.
  Registered to user account
  via ably.key.
end note

UserAccount .. "*" CLI

CLI ..> "*" Timesheet
note bottom on link
  **entailed __read and write__ access**
  (via the CLI)

  the user account must be the timesheet provider

  account<sub>u</sub> ∈
    account<sub>p</sub>.vf:primaryAccountable
end note

package Ably <<service>> {
  class AblyKey {
    keyid
    name
    secret
    capabilities : string
  }
  note left of AblyKey::name
    account<sub>u</sub>
  end note
  note left of AblyKey::capabilities
    Defines channel
    access and thus,
    timesheet access
  end note

  UserAccount "1" - - "*" AblyKey
}

@enduml

PlantUML version 1.2021.10(Mon Aug 30 14:43:48 BST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>