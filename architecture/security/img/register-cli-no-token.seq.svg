<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="640px" preserveAspectRatio="none" style="width:427px;height:640px;background:#FFFFFF;" version="1.1" viewBox="0 0 427 640" width="427px" zoomAndPan="magnify"><defs><filter height="300%" id="f8af9i9k7krvc" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f8af9i9k7krvc)" height="83.9316" style="stroke:#A80036;stroke-width:1.0;" width="10" x="163.5" y="141.7305"/><rect fill="#FFFFFF" filter="url(#f8af9i9k7krvc)" height="321.5488" style="stroke:#A80036;stroke-width:1.0;" width="10" x="163.5" y="254.9727"/><rect fill="#FFFFFF" filter="url(#f8af9i9k7krvc)" height="247.6172" style="stroke:#A80036;stroke-width:1.0;" width="10" x="265.5" y="299.5938"/><rect fill="#FFFFFF" filter="url(#f8af9i9k7krvc)" height="95.2422" style="stroke:#A80036;stroke-width:1.0;" width="10" x="270.5" y="415.8359"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="36" x2="36" y1="40.4883" y2="633.832"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="168" x2="168" y1="40.4883" y2="633.832"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="270" x2="270" y1="40.4883" y2="633.832"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="390.5" x2="390.5" y1="40.4883" y2="633.832"/><rect fill="#FEFECE" filter="url(#f8af9i9k7krvc)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="45" x="12" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="19" y="25.5352">User</text><rect fill="#FEFECE" filter="url(#f8af9i9k7krvc)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="35" x="149" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21" x="156" y="25.5352">CLI</text><rect fill="#FEFECE" filter="url(#f8af9i9k7krvc)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="71" x="233" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="240" y="25.5352">Gateway</text><rect fill="#FEFECE" filter="url(#f8af9i9k7krvc)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="44" x="366.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="373.5" y="25.5352">Ably</text><rect fill="#FFFFFF" filter="url(#f8af9i9k7krvc)" height="83.9316" style="stroke:#A80036;stroke-width:1.0;" width="10" x="163.5" y="141.7305"/><rect fill="#FFFFFF" filter="url(#f8af9i9k7krvc)" height="321.5488" style="stroke:#A80036;stroke-width:1.0;" width="10" x="163.5" y="254.9727"/><rect fill="#FFFFFF" filter="url(#f8af9i9k7krvc)" height="247.6172" style="stroke:#A80036;stroke-width:1.0;" width="10" x="265.5" y="299.5938"/><rect fill="#FFFFFF" filter="url(#f8af9i9k7krvc)" height="95.2422" style="stroke:#A80036;stroke-width:1.0;" width="10" x="270.5" y="415.8359"/><path d="M5,55.4883 L5,110.4883 L418,110.4883 L418,65.4883 L408,55.4883 L5,55.4883 " fill="#FBFB77" filter="url(#f8af9i9k7krvc)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M408,55.4883 L408,65.4883 L418,65.4883 L408,55.4883 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="11" y="73.0566">Variant of</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="96" x="76" y="72.7329">register-cli</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="176" y="73.0566">with clickable email link.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209" x="11" y="88.3672">No need to copy &amp; paste a token!</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="11" y="103.6777">However, requires sharing of</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="64" x="196" y="103.354">ably.key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="264" y="103.6777">between GW sessions.</text><polygon fill="#A80036" points="151.5,137.7305,161.5,141.7305,151.5,145.7305,155.5,141.7305" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="36.5" x2="157.5" y1="141.7305" y2="141.7305"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="43.5" y="136.9883">open</text><path d="M113,154.7305 L113,194.7305 L220,194.7305 L220,164.7305 L210,154.7305 L113,154.7305 " fill="#FBFB77" filter="url(#f8af9i9k7krvc)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M210,154.7305 L210,164.7305 L220,164.7305 L210,154.7305 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="119" y="172.2988">No</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="64" x="141" y="171.9751">ably.key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="119" y="187.6094">or expired</text><polygon fill="#A80036" points="47.5,221.6621,37.5,225.6621,47.5,229.6621,43.5,225.6621" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="41.5" x2="167.5" y1="225.6621" y2="225.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="53.5" y="220.9199">"pls enter email"</text><polygon fill="#A80036" points="151.5,250.9727,161.5,254.9727,151.5,258.9727,155.5,254.9727" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="36.5" x2="157.5" y1="254.9727" y2="254.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="34" x="43.5" y="250.2305">email</text><polygon fill="#A80036" points="253.5,295.5938,263.5,299.5938,253.5,303.5938,257.5,299.5938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="173.5" x2="259.5" y1="299.5938" y2="299.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="180.5" y="279.541">machine-id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="180.5" y="294.8516">&amp; email</text><line style="stroke:#A80036;stroke-width:1.0;" x1="275.5" x2="317.5" y1="344.2148" y2="344.2148"/><line style="stroke:#A80036;stroke-width:1.0;" x1="317.5" x2="317.5" y1="344.2148" y2="357.2148"/><line style="stroke:#A80036;stroke-width:1.0;" x1="276.5" x2="317.5" y1="357.2148" y2="357.2148"/><polygon fill="#A80036" points="286.5,353.2148,276.5,357.2148,286.5,361.2148,282.5,357.2148" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="282.5" y="324.1621">create account</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="282.5" y="339.4727">if required</text><polygon fill="#A80036" points="47.5,382.5254,37.5,386.5254,47.5,390.5254,43.5,386.5254" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="41.5" x2="264.5" y1="386.5254" y2="386.5254"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="53.5" y="381.7832">activation link by email</text><polygon fill="#A80036" points="258.5,411.8359,268.5,415.8359,258.5,419.8359,262.5,415.8359" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="36.5" x2="264.5" y1="415.8359" y2="415.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="43.5" y="411.0938">click link</text><polygon fill="#A80036" points="291.5,456.457,281.5,460.457,291.5,464.457,287.5,460.457" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="378.5,456.457,388.5,460.457,378.5,464.457,382.5,460.457" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="285.5" x2="384.5" y1="460.457" y2="460.457"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="297.5" y="440.4043">create key &amp;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="297.5" y="455.7148">capabilities</text><line style="stroke:#A80036;stroke-width:1.0;" x1="280.5" x2="322.5" y1="510.0781" y2="510.0781"/><line style="stroke:#A80036;stroke-width:1.0;" x1="322.5" x2="322.5" y1="510.0781" y2="523.0781"/><line style="stroke:#A80036;stroke-width:1.0;" x1="275.5" x2="322.5" y1="523.0781" y2="523.0781"/><polygon fill="#A80036" points="285.5,519.0781,275.5,523.0781,285.5,527.0781,281.5,523.0781" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="287.5" y="490.0254">store key ID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="287.5" y="505.3359">in account</text><path d="M9,482.6123 L9,507.6123 L256,507.6123 L256,492.6123 L246,482.6123 L9,482.6123 " fill="#FFC0CB" filter="url(#f8af9i9k7krvc)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M246,482.6123 L246,492.6123 L256,492.6123 L246,482.6123 " fill="#FFC0CB" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226" x="15" y="500.1807">requires GW session-session comm</text><polygon fill="#A80036" points="184.5,543.2109,174.5,547.2109,184.5,551.2109,180.5,547.2109" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="178.5" x2="269.5" y1="547.2109" y2="547.2109"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="64" x="190.5" y="542.145">ably.key</text><polygon fill="#A80036" points="378.5,572.5215,388.5,576.5215,378.5,580.5215,382.5,576.5215" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="168.5" x2="384.5" y1="576.5215" y2="576.5215"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="175.5" y="571.7793">connect to timesheet channels</text><path d="M17,589.5215 L17,614.5215 L188,614.5215 L188,599.5215 L178,589.5215 L17,589.5215 " fill="#FBFB77" filter="url(#f8af9i9k7krvc)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M178,589.5215 L178,599.5215 L188,599.5215 L178,589.5215 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="30" y="607.0898">Proceed with session</text><!--MD5=[dc3e6df78def474e3e09450cbd2f1941]
@startuml
'https://plantuml.com/sequence-diagram

hide footbox

note across
Variant of ""register-cli"" with clickable email link.
No need to copy & paste a token!
However, requires sharing of ""ably.key"" between GW sessions.
end note

User -> CLI ++: open
note over CLI: No ""ably.key""\nor expired
CLI - -> User - -: "pls enter email"
User -> CLI ++: email
CLI -> Gateway ++: machine-id\n& email
Gateway -> Gateway: create account\nif required
Gateway - -> User: activation link by email
User -> Gateway ++: click link
Gateway <-> Ably: create key &\ncapabilities
Gateway -> Gateway - -: store key ID\nin account
note left #pink: requires GW session-session comm
Gateway - -> CLI - -: ""ably.key""
CLI -> Ably - -: connect to timesheet channels
note over User, CLI: Proceed with session

@enduml

@startuml

hide footbox

note across
Variant of ""register-cli"" with clickable email link.
No need to copy & paste a token!
However, requires sharing of ""ably.key"" between GW sessions.
end note

User -> CLI ++: open
note over CLI: No ""ably.key""\nor expired
CLI - -> User - -: "pls enter email"
User -> CLI ++: email
CLI -> Gateway ++: machine-id\n& email
Gateway -> Gateway: create account\nif required
Gateway - -> User: activation link by email
User -> Gateway ++: click link
Gateway <-> Ably: create key &\ncapabilities
Gateway -> Gateway - -: store key ID\nin account
note left #pink: requires GW session-session comm
Gateway - -> CLI - -: ""ably.key""
CLI -> Ably - -: connect to timesheet channels
note over User, CLI: Proceed with session

@enduml

PlantUML version 1.2021.10(Mon Aug 30 14:43:48 BST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>